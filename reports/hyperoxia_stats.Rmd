---
title: "hyperoxia_stats"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Users/grigorijschleifer/Desktop/Hyperoxia-2020/data/")
```

```{r echo=FALSE, warning=FALSE, include=FALSE}
library(tableone)
theme_set(theme_light())
```

```{r echo=FALSE, warning=FALSE, include=FALSE}
# write_csv(cohort_pao2, "~/Desktop/MIMIC_III/PT_Hyperoxia_2020/cohort_pao2.csv")
# write_csv(cohort_pao2_staged, "~/Desktop/MIMIC_III/PT_Hyperoxia_2020/cohort_pao2_staged.csv")
cohort_pao2 <- read_csv("~/Desktop/Hyperoxia-2020/data/report_data/cohort_pao2.csv")
```

```{r}
CreateCatTable(
    vars = c("aki_7day_new", "sofa", "hospmort30day"),
    strata = "two_oxy_level",
    data = cohort_pao2
)
# aki_48hr_c
uni_logistic <-
    glm(
        formula = aki_7day_new ~ two_oxy_level + two_oxy_level:sofa,
        data = cohort_pao2,
        family = binomial
    )

confint.lm(uni_logistic)

# mortality_30day
model <-
    glm(formula = hospmort30day ~ two_oxy_level,
        data = cohort_pao2,
        family = binomial)

exp(cbind(OR = coef(model), confint.default(model)))
```

